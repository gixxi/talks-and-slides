<h1>Synopsis</h1>

<p>This documents aims to give an introduction to both prolog as well as logical programming 
using clojure's core.logic. core.logic is prolog-like constraint-base, nominal logic as well as relation programming within clojure. </p>

<p>The examples within the wikipedia article on prolog http://de.wikipedia.org/wiki/Prolog_(Programmiersprache) are translated into clojure.core providing both 
an indroduction both in clojure's most important syntax elements and control structures as well as in the main idea behind functional and logical programming.</p>

<h1>The setup</h1>

<p>I'am using Sun/Oracle <em>jdk1.7</em> in conjunction to <em>clojure 1.5.1</em> and <em>core.logic 0.8.5</em>. For building the project I use <em>leiningen</em></p>

<pre>
(defproject prologtocorelogic "0.1.0-SNAPSHOT"
  :description "FIXME: write description"
  :url "http://example.com/FIXME"
  :license {:name "Eclipse Public License"
            :url "http://www.eclipse.org/legal/epl-v10.html"}
  :dependencies [[org.clojure/clojure "1.5.1"]
                 [org.clojure/core.logic "0.8.5"]])
</pre>

<p>So install leiningen from https://github.com/technomancy/leiningen and start a new project using</p>

<pre>
lein new prologtocorelogic
</pre>

<p>For editing and incremental coding is use nRepl enrolled by leiningen with <em>vim</em> connected via <em>fireplace</em>.</p>

<p>So after starting the clojure nRepl within the newly created directory <em>prologtocorelogic</em> using</p>

<pre>
lein repl
</pre>

<p>you should something like this</p>

<pre>
nREPL server started on port 38935 on host 127.0.0.1
REPL-y 0.2.1
Clojure 1.5.1
    Docs: (doc function-name-here)
          (find-doc "part-of-name-here")
  Source: (source function-name-here)
 Javadoc: (javadoc java-object-or-class-here)
    Exit: Control+D or (exit) or (quit)

user=> 
</pre>

<p>Now you can create an connection from your vim instance to the nRepl by entering within vim</p>

<pre>
:Connect nrepl://localhost:38935
</pre>

<p>The current clojure source file gets evaluated and made available for usage in the repl session using</p>

<pre>:Require</pre>

<p>or</p>

<pre>:Require!</pre>

<p>The outermost expression under the cursor gets evaluated using</p>

<pre>
:Eval
</pre>

<p>Enter <pre>:help fireplace</pre> to get more information on the interaction vim -> nRepl.</p>

<h1>The invariant clojure file header</h1>

<p>Consider this as invariant for all examples. This tells the clojure compiler that our namespace is <em>prologtoclojure.core</em></p>

<p><table cellpadding=1 cellspacing=0 width="100%" class="sourcetable"><tr><th width="3%"/><th width="97%"/></tr><tr><td style='background-color: #eeeeee; border-right: 1px solid #eeaaaa; '><span></span></td><td style='background-color: #eeaaaa; padding-left: 15px; '><span>Clojure namespace you're programming in</span></td></tr><tr><td style='background-color: #eeeeee; border-right: 1px solid #eeaaaa; '><span>1</span></td><td style='background-color: #fdfdfd; '><span style="font-family: 'Courier'; font-size: 1.2em">(</span><span style="font-family: 'Courier'; font-size: 1.2em; color: #008000; font-weight: bold">ns&nbsp;</span><span style="font-family: 'Courier'; font-size: 1.2em; color: #19177C">prologtocorelogic.core</span></td></tr><tr><td style='background-color: #eeeeee; border-right: 1px solid #eeaaaa; '><span>2</span></td><td style='background-color: #fafafa; '>&nbsp;&nbsp;<span style="font-family: 'Courier'; font-size: 1.2em">(</span><span style="font-family: 'Courier'; font-size: 1.2em; color: #19177C">:refer-clojure</span>&nbsp;<span style="font-family: 'Courier'; font-size: 1.2em; color: #19177C">:exclude</span>&nbsp;<span style="font-family: 'Courier'; font-size: 1.2em">[</span><span style="font-family: 'Courier'; font-size: 1.2em; color: #19177C">==</span><span style="font-family: 'Courier'; font-size: 1.2em">]</span><span style="font-family: 'Courier'; font-size: 1.2em">)</span></td></tr><tr><td style='background-color: #eeeeee; border-right: 1px solid #eeaaaa; '><span>3</span></td><td style='background-color: #fdfdfd; '>&nbsp;&nbsp;<span style="font-family: 'Courier'; font-size: 1.2em">(</span><span style="font-family: 'Courier'; font-size: 1.2em; color: #19177C">:use</span>&nbsp;<span style="font-family: 'Courier'; font-size: 1.2em">[</span><span style="font-family: 'Courier'; font-size: 1.2em; color: #19177C">clojure.core.logic</span><span style="font-family: 'Courier'; font-size: 1.2em">]</span><span style="font-family: 'Courier'; font-size: 1.2em">)</span></td></tr><tr><td style='background-color: #eeeeee; border-right: 1px solid #eeaaaa; '><span>4</span></td><td style='background-color: #fafafa; '>&nbsp;&nbsp;<span style="font-family: 'Courier'; font-size: 1.2em">(</span><span style="font-family: 'Courier'; font-size: 1.2em; color: #19177C">:require</span>&nbsp;<span style="font-family: 'Courier'; font-size: 1.2em">[</span><span style="font-family: 'Courier'; font-size: 1.2em; color: #19177C">clojure.core.logic.pldb</span>&nbsp;<span style="font-family: 'Courier'; font-size: 1.2em; color: #19177C">:as</span>&nbsp;<span style="font-family: 'Courier'; font-size: 1.2em; color: #19177C">facts</span><span style="font-family: 'Courier'; font-size: 1.2em">]</span><span style="font-family: 'Courier'; font-size: 1.2em">)</span></td></tr><tr><td style='background-color: #eeeeee; border-right: 1px solid #eeaaaa; '><span>5</span></td><td style='background-color: #fdfdfd; '>&nbsp;&nbsp;<span style="font-family: 'Courier'; font-size: 1.2em">(</span><span style="font-family: 'Courier'; font-size: 1.2em; color: #19177C">:require</span>&nbsp;<span style="font-family: 'Courier'; font-size: 1.2em">[</span><span style="font-family: 'Courier'; font-size: 1.2em; color: #19177C">clojure.core.logic.fd</span>&nbsp;<span style="font-family: 'Courier'; font-size: 1.2em; color: #19177C">:as</span>&nbsp;<span style="font-family: 'Courier'; font-size: 1.2em; color: #19177C">fd</span><span style="font-family: 'Courier'; font-size: 1.2em">]</span><span style="font-family: 'Courier'; font-size: 1.2em">)</span><span style="font-family: 'Courier'; font-size: 1.2em">)</span></td></tr></table></p>

<h1>Relational Programming</h1>

<h2>Defining a factbase and relations</h2>

<p>A relational programm consists of a factbase with facts and relations. Facts represent propositions on objects. We express propositions using relations. A relation
consists of <em>predicate symbol</em> as well as a ordered sequence of <em>terms</em>. In core.logic one can express just atomic propositions. In prolog one can also define
compound propositions.</p>

<p><table cellpadding=1 cellspacing=0 width="100%" class="sourcetable"><tr><th width="3%"/><th width="48%"/><th width="48%"/></tr><tr><td style='background-color: #eeeeee; border-right: 1px solid #eeaaaa; '><span></span></td><td style='background-color: #eeaaaa; padding-left: 15px; '><span>Prolog</span></td><td style='background-color: #eeaaaa; padding-left: 15px; '><span>Clojure core.logic</span></td></tr><tr><td style='background-color: #eeeeee; border-right: 1px solid #eeaaaa; '><span>1</span></td><td style='background-color: #fdfdfd; '><span style="font-family: 'Courier'; font-size: 1.2em; color: #0000FF">mann</span><span style="font-family: 'Courier'; font-size: 1.2em">(</span><span style="font-family: 'Courier'; font-size: 1.2em; color: #BA2121">adam</span><span style="font-family: 'Courier'; font-size: 1.2em">)</span><span style="font-family: 'Courier'; font-size: 1.2em">.</span></td><td style='background-color: #f8f8f8; '><span style="font-family: 'Courier'; font-size: 1.2em">(</span><span style="font-family: 'Courier'; font-size: 1.2em; color: #0000FF">facts/db-rel</span>&nbsp;<span style="font-family: 'Courier'; font-size: 1.2em; color: #19177C">mann</span>&nbsp;<span style="font-family: 'Courier'; font-size: 1.2em; color: #19177C">n</span><span style="font-family: 'Courier'; font-size: 1.2em">)</span></td></tr><tr><td style='background-color: #eeeeee; border-right: 1px solid #eeaaaa; '><span>2</span></td><td style='background-color: #fafafa; '><span style="font-family: 'Courier'; font-size: 1.2em; color: #0000FF">mann</span><span style="font-family: 'Courier'; font-size: 1.2em">(</span><span style="font-family: 'Courier'; font-size: 1.2em; color: #BA2121">tobias</span><span style="font-family: 'Courier'; font-size: 1.2em">)</span><span style="font-family: 'Courier'; font-size: 1.2em">.</span></td><td style='background-color: #f5f5f5; '><span style="font-family: 'Courier'; font-size: 1.2em">(</span><span style="font-family: 'Courier'; font-size: 1.2em; color: #0000FF">facts/db-rel</span>&nbsp;<span style="font-family: 'Courier'; font-size: 1.2em; color: #19177C">frau</span>&nbsp;<span style="font-family: 'Courier'; font-size: 1.2em; color: #19177C">n</span><span style="font-family: 'Courier'; font-size: 1.2em">)</span></td></tr><tr><td style='background-color: #eeeeee; border-right: 1px solid #eeaaaa; '><span>3</span></td><td style='background-color: #fdfdfd; '><span style="font-family: 'Courier'; font-size: 1.2em; color: #0000FF">mann</span><span style="font-family: 'Courier'; font-size: 1.2em">(</span><span style="font-family: 'Courier'; font-size: 1.2em; color: #BA2121">frank</span><span style="font-family: 'Courier'; font-size: 1.2em">)</span><span style="font-family: 'Courier'; font-size: 1.2em">.</span></td><td style='background-color: #f8f8f8; '><span style="font-family: 'Courier'; font-size: 1.2em">(</span><span style="font-family: 'Courier'; font-size: 1.2em; color: #0000FF">facts/db-rel</span>&nbsp;<span style="font-family: 'Courier'; font-size: 1.2em; color: #19177C">vater</span>&nbsp;<span style="font-family: 'Courier'; font-size: 1.2em; color: #19177C">v</span>&nbsp;<span style="font-family: 'Courier'; font-size: 1.2em; color: #19177C">k</span><span style="font-family: 'Courier'; font-size: 1.2em">)</span></td></tr><tr><td style='background-color: #eeeeee; border-right: 1px solid #eeaaaa; '><span>4</span></td><td style='background-color: #fafafa; '><span style="font-family: 'Courier'; font-size: 1.2em; color: #0000FF">frau</span><span style="font-family: 'Courier'; font-size: 1.2em">(</span><span style="font-family: 'Courier'; font-size: 1.2em; color: #BA2121">eva</span><span style="font-family: 'Courier'; font-size: 1.2em">)</span><span style="font-family: 'Courier'; font-size: 1.2em">.</span></td><td style='background-color: #f5f5f5; '><span style="font-family: 'Courier'; font-size: 1.2em">(</span><span style="font-family: 'Courier'; font-size: 1.2em; color: #0000FF">facts/db-rel</span>&nbsp;<span style="font-family: 'Courier'; font-size: 1.2em; color: #19177C">mutter</span>&nbsp;<span style="font-family: 'Courier'; font-size: 1.2em; color: #19177C">m</span>&nbsp;<span style="font-family: 'Courier'; font-size: 1.2em; color: #19177C">k</span><span style="font-family: 'Courier'; font-size: 1.2em">)</span></td></tr><tr><td style='background-color: #eeeeee; border-right: 1px solid #eeaaaa; '><span>5</span></td><td style='background-color: #fdfdfd; '><span style="font-family: 'Courier'; font-size: 1.2em; color: #0000FF">frau</span><span style="font-family: 'Courier'; font-size: 1.2em">(</span><span style="font-family: 'Courier'; font-size: 1.2em; color: #BA2121">daniela</span><span style="font-family: 'Courier'; font-size: 1.2em">)</span><span style="font-family: 'Courier'; font-size: 1.2em">.</span></td><td style='background-color: #f8f8f8; '></td></tr><tr><td style='background-color: #eeeeee; border-right: 1px solid #eeaaaa; '><span>6</span></td><td style='background-color: #fafafa; '><span style="font-family: 'Courier'; font-size: 1.2em; color: #0000FF">frau</span><span style="font-family: 'Courier'; font-size: 1.2em">(</span><span style="font-family: 'Courier'; font-size: 1.2em; color: #BA2121">ulrike</span><span style="font-family: 'Courier'; font-size: 1.2em">)</span><span style="font-family: 'Courier'; font-size: 1.2em">.</span></td><td style='background-color: #f5f5f5; '><span style="font-family: 'Courier'; font-size: 1.2em">(</span><span style="font-family: 'Courier'; font-size: 1.2em; color: #008000; font-weight: bold">def&nbsp;</span><span style="font-family: 'Courier'; font-size: 1.2em; color: #19177C">factbase</span></td></tr><tr><td style='background-color: #eeeeee; border-right: 1px solid #eeaaaa; '><span>7</span></td><td style='background-color: #fdfdfd; '><span style="font-family: 'Courier'; font-size: 1.2em; color: #0000FF">vater</span><span style="font-family: 'Courier'; font-size: 1.2em">(</span><span style="font-family: 'Courier'; font-size: 1.2em; color: #BA2121">adam</span><span style="font-family: 'Courier'; font-size: 1.2em">,</span><span style="font-family: 'Courier'; font-size: 1.2em; color: #BA2121">tobias</span><span style="font-family: 'Courier'; font-size: 1.2em">)</span><span style="font-family: 'Courier'; font-size: 1.2em">.</span></td><td style='background-color: #f8f8f8; '>&nbsp;&nbsp;<span style="font-family: 'Courier'; font-size: 1.2em">(</span><span style="font-family: 'Courier'; font-size: 1.2em; color: #0000FF">facts/db</span></td></tr><tr><td style='background-color: #eeeeee; border-right: 1px solid #eeaaaa; '><span>8</span></td><td style='background-color: #fafafa; '><span style="font-family: 'Courier'; font-size: 1.2em; color: #0000FF">vater</span><span style="font-family: 'Courier'; font-size: 1.2em">(</span><span style="font-family: 'Courier'; font-size: 1.2em; color: #BA2121">tobias</span><span style="font-family: 'Courier'; font-size: 1.2em">,</span><span style="font-family: 'Courier'; font-size: 1.2em; color: #BA2121">frank</span><span style="font-family: 'Courier'; font-size: 1.2em">)</span><span style="font-family: 'Courier'; font-size: 1.2em">.</span></td><td style='background-color: #f5f5f5; '>&nbsp;&nbsp;&nbsp;&nbsp;<span style="font-family: 'Courier'; font-size: 1.2em">[</span><span style="font-family: 'Courier'; font-size: 1.2em; color: #19177C">mann</span>&nbsp;<span style="font-family: 'Courier'; font-size: 1.2em; color: #19177C">:adam</span><span style="font-family: 'Courier'; font-size: 1.2em">]</span></td></tr><tr><td style='background-color: #eeeeee; border-right: 1px solid #eeaaaa; '><span>9</span></td><td style='background-color: #fdfdfd; '><span style="font-family: 'Courier'; font-size: 1.2em; color: #0000FF">vater</span><span style="font-family: 'Courier'; font-size: 1.2em">(</span><span style="font-family: 'Courier'; font-size: 1.2em; color: #BA2121">tobias</span><span style="font-family: 'Courier'; font-size: 1.2em">,</span><span style="font-family: 'Courier'; font-size: 1.2em; color: #BA2121">ulrike</span><span style="font-family: 'Courier'; font-size: 1.2em">)</span><span style="font-family: 'Courier'; font-size: 1.2em">.</span></td><td style='background-color: #f8f8f8; '>&nbsp;&nbsp;&nbsp;&nbsp;<span style="font-family: 'Courier'; font-size: 1.2em">[</span><span style="font-family: 'Courier'; font-size: 1.2em; color: #19177C">mann</span>&nbsp;<span style="font-family: 'Courier'; font-size: 1.2em; color: #19177C">:tobias</span><span style="font-family: 'Courier'; font-size: 1.2em">]</span></td></tr><tr><td style='background-color: #eeeeee; border-right: 1px solid #eeaaaa; '><span>10</span></td><td style='background-color: #fafafa; '><span style="font-family: 'Courier'; font-size: 1.2em; color: #0000FF">mutter</span><span style="font-family: 'Courier'; font-size: 1.2em">(</span><span style="font-family: 'Courier'; font-size: 1.2em; color: #BA2121">eva</span><span style="font-family: 'Courier'; font-size: 1.2em">,</span><span style="font-family: 'Courier'; font-size: 1.2em; color: #BA2121">tobias</span><span style="font-family: 'Courier'; font-size: 1.2em">)</span><span style="font-family: 'Courier'; font-size: 1.2em">.</span></td><td style='background-color: #f5f5f5; '>&nbsp;&nbsp;&nbsp;&nbsp;<span style="font-family: 'Courier'; font-size: 1.2em">[</span><span style="font-family: 'Courier'; font-size: 1.2em; color: #19177C">mann</span>&nbsp;<span style="font-family: 'Courier'; font-size: 1.2em; color: #19177C">:frank</span><span style="font-family: 'Courier'; font-size: 1.2em">]</span></td></tr><tr><td style='background-color: #eeeeee; border-right: 1px solid #eeaaaa; '><span>11</span></td><td style='background-color: #fdfdfd; '><span style="font-family: 'Courier'; font-size: 1.2em; color: #0000FF">mutter</span><span style="font-family: 'Courier'; font-size: 1.2em">(</span><span style="font-family: 'Courier'; font-size: 1.2em; color: #BA2121">daniela</span><span style="font-family: 'Courier'; font-size: 1.2em">,</span><span style="font-family: 'Courier'; font-size: 1.2em; color: #BA2121">frank</span><span style="font-family: 'Courier'; font-size: 1.2em">)</span><span style="font-family: 'Courier'; font-size: 1.2em">.</span></td><td style='background-color: #f8f8f8; '>&nbsp;&nbsp;&nbsp;&nbsp;<span style="font-family: 'Courier'; font-size: 1.2em">[</span><span style="font-family: 'Courier'; font-size: 1.2em; color: #19177C">frau</span>&nbsp;<span style="font-family: 'Courier'; font-size: 1.2em; color: #19177C">:eva</span><span style="font-family: 'Courier'; font-size: 1.2em">]</span></td></tr><tr><td style='background-color: #eeeeee; border-right: 1px solid #eeaaaa; '><span>12</span></td><td style='background-color: #fafafa; '><span style="font-family: 'Courier'; font-size: 1.2em; color: #0000FF">mutter</span><span style="font-family: 'Courier'; font-size: 1.2em">(</span><span style="font-family: 'Courier'; font-size: 1.2em; color: #BA2121">daniela</span><span style="font-family: 'Courier'; font-size: 1.2em">,</span><span style="font-family: 'Courier'; font-size: 1.2em; color: #BA2121">ulrike</span><span style="font-family: 'Courier'; font-size: 1.2em">)</span><span style="font-family: 'Courier'; font-size: 1.2em">.</span></td><td style='background-color: #f5f5f5; '>&nbsp;&nbsp;&nbsp;&nbsp;<span style="font-family: 'Courier'; font-size: 1.2em">[</span><span style="font-family: 'Courier'; font-size: 1.2em; color: #19177C">frau</span>&nbsp;<span style="font-family: 'Courier'; font-size: 1.2em; color: #19177C">:daniela</span><span style="font-family: 'Courier'; font-size: 1.2em">]</span></td></tr><tr><td style='background-color: #eeeeee; border-right: 1px solid #eeaaaa; '><span>13</span></td><td style='background-color: #fdfdfd; '></td><td style='background-color: #f8f8f8; '>&nbsp;&nbsp;&nbsp;&nbsp;<span style="font-family: 'Courier'; font-size: 1.2em">[</span><span style="font-family: 'Courier'; font-size: 1.2em; color: #19177C">frau</span>&nbsp;<span style="font-family: 'Courier'; font-size: 1.2em; color: #19177C">:ulrike</span><span style="font-family: 'Courier'; font-size: 1.2em">]</span></td></tr><tr><td style='background-color: #eeeeee; border-right: 1px solid #eeaaaa; '><span>14</span></td><td style='background-color: #fafafa; '></td><td style='background-color: #f5f5f5; '>&nbsp;&nbsp;&nbsp;&nbsp;<span style="font-family: 'Courier'; font-size: 1.2em">[</span><span style="font-family: 'Courier'; font-size: 1.2em; color: #19177C">vater</span>&nbsp;<span style="font-family: 'Courier'; font-size: 1.2em; color: #19177C">:adam</span>&nbsp;<span style="font-family: 'Courier'; font-size: 1.2em; color: #19177C">:tobias</span><span style="font-family: 'Courier'; font-size: 1.2em">]</span></td></tr><tr><td style='background-color: #eeeeee; border-right: 1px solid #eeaaaa; '><span>15</span></td><td style='background-color: #fdfdfd; '></td><td style='background-color: #f8f8f8; '>&nbsp;&nbsp;&nbsp;&nbsp;<span style="font-family: 'Courier'; font-size: 1.2em">[</span><span style="font-family: 'Courier'; font-size: 1.2em; color: #19177C">vater</span>&nbsp;<span style="font-family: 'Courier'; font-size: 1.2em; color: #19177C">:tobias</span>&nbsp;<span style="font-family: 'Courier'; font-size: 1.2em; color: #19177C">:frank</span><span style="font-family: 'Courier'; font-size: 1.2em">]</span></td></tr><tr><td style='background-color: #eeeeee; border-right: 1px solid #eeaaaa; '><span>16</span></td><td style='background-color: #fafafa; '></td><td style='background-color: #f5f5f5; '>&nbsp;&nbsp;&nbsp;&nbsp;<span style="font-family: 'Courier'; font-size: 1.2em">[</span><span style="font-family: 'Courier'; font-size: 1.2em; color: #19177C">vater</span>&nbsp;<span style="font-family: 'Courier'; font-size: 1.2em; color: #19177C">:tobias</span>&nbsp;<span style="font-family: 'Courier'; font-size: 1.2em; color: #19177C">:ulrike</span><span style="font-family: 'Courier'; font-size: 1.2em">]</span></td></tr><tr><td style='background-color: #eeeeee; border-right: 1px solid #eeaaaa; '><span>17</span></td><td style='background-color: #fdfdfd; '></td><td style='background-color: #f8f8f8; '>&nbsp;&nbsp;&nbsp;&nbsp;<span style="font-family: 'Courier'; font-size: 1.2em">[</span><span style="font-family: 'Courier'; font-size: 1.2em; color: #19177C">mutter</span>&nbsp;<span style="font-family: 'Courier'; font-size: 1.2em; color: #19177C">:eva</span>&nbsp;<span style="font-family: 'Courier'; font-size: 1.2em; color: #19177C">:tobias</span><span style="font-family: 'Courier'; font-size: 1.2em">]</span></td></tr><tr><td style='background-color: #eeeeee; border-right: 1px solid #eeaaaa; '><span>18</span></td><td style='background-color: #fafafa; '></td><td style='background-color: #f5f5f5; '>&nbsp;&nbsp;&nbsp;&nbsp;<span style="font-family: 'Courier'; font-size: 1.2em">[</span><span style="font-family: 'Courier'; font-size: 1.2em; color: #19177C">mutter</span>&nbsp;<span style="font-family: 'Courier'; font-size: 1.2em; color: #19177C">:daniela</span>&nbsp;<span style="font-family: 'Courier'; font-size: 1.2em; color: #19177C">:frank</span><span style="font-family: 'Courier'; font-size: 1.2em">]</span></td></tr><tr><td style='background-color: #eeeeee; border-right: 1px solid #eeaaaa; '><span>19</span></td><td style='background-color: #fdfdfd; '></td><td style='background-color: #f8f8f8; '>&nbsp;&nbsp;&nbsp;&nbsp;<span style="font-family: 'Courier'; font-size: 1.2em">[</span><span style="font-family: 'Courier'; font-size: 1.2em; color: #19177C">mutter</span>&nbsp;<span style="font-family: 'Courier'; font-size: 1.2em; color: #19177C">:daniela</span>&nbsp;<span style="font-family: 'Courier'; font-size: 1.2em; color: #19177C">:ulrike</span><span style="font-family: 'Courier'; font-size: 1.2em">]</span><span style="font-family: 'Courier'; font-size: 1.2em">)</span><span style="font-family: 'Courier'; font-size: 1.2em">)</span></td></tr></table></p>

<h2>Running a query</h2>

<p>Core of both Prolog as well as core.logic is a logic interpreter. The programmer can ask a query, the logical interpreter tries to solve using induction over a set of constraints. Constraints are propositions expressed using relations and constraints over finite domains.</p>

<p><table cellpadding=1 cellspacing=0 width="100%" class="sourcetable"><tr><th width="3%"/><th width="48%"/><th width="48%"/></tr><tr><td style='background-color: #eeeeee; border-right: 1px solid #eeaaaa; '><span></span></td><td style='background-color: #eeaaaa; padding-left: 15px; '><span>Prolog</span></td><td style='background-color: #eeaaaa; padding-left: 15px; '><span>Clojure core.logic</span></td></tr><tr><td style='background-color: #eeeeee; border-right: 1px solid #eeaaaa; '><span>1</span></td><td style='background-color: #fdfdfd; '><span style="font-family: 'Courier'; font-size: 1.2em; color: #BA2121">?-</span>&nbsp;<span style="font-family: 'Courier'; font-size: 1.2em; color: #0000FF">mann</span><span style="font-family: 'Courier'; font-size: 1.2em">(</span><span style="font-family: 'Courier'; font-size: 1.2em; color: #BA2121">tobias</span><span style="font-family: 'Courier'; font-size: 1.2em">)</span><span style="font-family: 'Courier'; font-size: 1.2em">.</span></td><td style='background-color: #f8f8f8; '><span style="font-family: 'Courier'; font-size: 1.2em">(</span><span style="font-family: 'Courier'; font-size: 1.2em; color: #0000FF">facts/with-db</span></td></tr><tr><td style='background-color: #eeeeee; border-right: 1px solid #eeaaaa; '><span>2</span></td><td style='background-color: #fafafa; '><span style="font-family: 'Courier'; font-size: 1.2em; color: #BA2121">yes</span><span style="font-family: 'Courier'; font-size: 1.2em">.</span></td><td style='background-color: #f5f5f5; '>&nbsp;&nbsp;<span style="font-family: 'Courier'; font-size: 1.2em; color: #19177C">factbase</span></td></tr><tr><td style='background-color: #eeeeee; border-right: 1px solid #eeaaaa; '><span>3</span></td><td style='background-color: #fdfdfd; '><span style="font-family: 'Courier'; font-size: 1.2em; color: #BA2121">?-</span>&nbsp;<span style="font-family: 'Courier'; font-size: 1.2em; color: #0000FF">mann</span><span style="font-family: 'Courier'; font-size: 1.2em">(</span><span style="font-family: 'Courier'; font-size: 1.2em; color: #BA2121">heinrich</span><span style="font-family: 'Courier'; font-size: 1.2em">)</span><span style="font-family: 'Courier'; font-size: 1.2em">.</span></td><td style='background-color: #f8f8f8; '>&nbsp;&nbsp;<span style="font-family: 'Courier'; font-size: 1.2em">(</span><span style="font-family: 'Courier'; font-size: 1.2em; color: #0000FF">run<em></span>&nbsp;<span style="font-family: 'Courier'; font-size: 1.2em">[</span><span style="font-family: 'Courier'; font-size: 1.2em; color: #19177C">q</span><span style="font-family: 'Courier'; font-size: 1.2em">]</span></td></tr><tr><td style='background-color: #eeeeee; border-right: 1px solid #eeaaaa; '><span>4</span></td><td style='background-color: #fafafa; '><span style="font-family: 'Courier'; font-size: 1.2em; color: #BA2121">no</span><span style="font-family: 'Courier'; font-size: 1.2em">.</span></td><td style='background-color: #f5f5f5; '>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="font-family: 'Courier'; font-size: 1.2em">(</span><span style="font-family: 'Courier'; font-size: 1.2em; color: #0000FF">mann</span>&nbsp;<span style="font-family: 'Courier'; font-size: 1.2em; color: #19177C">:tobias</span><span style="font-family: 'Courier'; font-size: 1.2em">)</span></td></tr><tr><td style='background-color: #eeeeee; border-right: 1px solid #eeaaaa; '><span>5</span></td><td style='background-color: #fdfdfd; '></td><td style='background-color: #f8f8f8; '>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="font-family: 'Courier'; font-size: 1.2em">(</span><span style="font-family: 'Courier'; font-size: 1.2em; color: #008000">==&nbsp;</span><span style="font-family: 'Courier'; font-size: 1.2em; color: #19177C">q</span>&nbsp;<span style="font-family: 'Courier'; font-size: 1.2em; color: #19177C">true</span><span style="font-family: 'Courier'; font-size: 1.2em">)</span><span style="font-family: 'Courier'; font-size: 1.2em">)</span><span style="font-family: 'Courier'; font-size: 1.2em">)</span></td></tr><tr><td style='background-color: #eeeeee; border-right: 1px solid #eeaaaa; '><span>6</span></td><td style='background-color: #fafafa; '></td><td style='background-color: #f5f5f5; '><span style="font-family: 'Courier'; font-size: 1.2em; color: #19177C">user=&gt;</span>&nbsp;<span style="font-family: 'Courier'; font-size: 1.2em">(</span><span style="font-family: 'Courier'; font-size: 1.2em; color: #0000FF">true</span><span style="font-family: 'Courier'; font-size: 1.2em">)</span></td></tr><tr><td style='background-color: #eeeeee; border-right: 1px solid #eeaaaa; '><span>7</span></td><td style='background-color: #fdfdfd; '></td><td style='background-color: #f8f8f8; '></td></tr><tr><td style='background-color: #eeeeee; border-right: 1px solid #eeaaaa; '><span>8</span></td><td style='background-color: #fafafa; '></td><td style='background-color: #f5f5f5; '><span style="font-family: 'Courier'; font-size: 1.2em">(</span><span style="font-family: 'Courier'; font-size: 1.2em; color: #0000FF">facts/with-db</span></td></tr><tr><td style='background-color: #eeeeee; border-right: 1px solid #eeaaaa; '><span>9</span></td><td style='background-color: #fdfdfd; '></td><td style='background-color: #f8f8f8; '>&nbsp;&nbsp;<span style="font-family: 'Courier'; font-size: 1.2em; color: #19177C">factbase</span></td></tr><tr><td style='background-color: #eeeeee; border-right: 1px solid #eeaaaa; '><span>10</span></td><td style='background-color: #fafafa; '></td><td style='background-color: #f5f5f5; '>&nbsp;&nbsp;<span style="font-family: 'Courier'; font-size: 1.2em">(</span><span style="font-family: 'Courier'; font-size: 1.2em; color: #0000FF">run</em></span>&nbsp;<span style="font-family: 'Courier'; font-size: 1.2em">[</span><span style="font-family: 'Courier'; font-size: 1.2em; color: #19177C">q</span><span style="font-family: 'Courier'; font-size: 1.2em">]</span></td></tr><tr><td style='background-color: #eeeeee; border-right: 1px solid #eeaaaa; '><span>11</span></td><td style='background-color: #fdfdfd; '></td><td style='background-color: #f8f8f8; '>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="font-family: 'Courier'; font-size: 1.2em">(</span><span style="font-family: 'Courier'; font-size: 1.2em; color: #0000FF">mann</span>&nbsp;<span style="font-family: 'Courier'; font-size: 1.2em; color: #19177C">:heinrich</span><span style="font-family: 'Courier'; font-size: 1.2em">)</span></td></tr><tr><td style='background-color: #eeeeee; border-right: 1px solid #eeaaaa; '><span>12</span></td><td style='background-color: #fafafa; '></td><td style='background-color: #f5f5f5; '>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="font-family: 'Courier'; font-size: 1.2em">(</span><span style="font-family: 'Courier'; font-size: 1.2em; color: #008000">==&nbsp;</span><span style="font-family: 'Courier'; font-size: 1.2em; color: #19177C">q</span>&nbsp;<span style="font-family: 'Courier'; font-size: 1.2em; color: #19177C">true</span><span style="font-family: 'Courier'; font-size: 1.2em">)</span><span style="font-family: 'Courier'; font-size: 1.2em">)</span><span style="font-family: 'Courier'; font-size: 1.2em">)</span></td></tr><tr><td style='background-color: #eeeeee; border-right: 1px solid #eeaaaa; '><span>13</span></td><td style='background-color: #fdfdfd; '></td><td style='background-color: #f8f8f8; '><span style="font-family: 'Courier'; font-size: 1.2em; color: #19177C">user=&gt;</span>&nbsp;<span style="font-family: 'Courier'; font-size: 1.2em">(</span><span style="font-family: 'Courier'; font-size: 1.2em">)</span></td></tr></table></p>

<p>In core.logic the logic interpreter answers the question by unifying a logic variable. Unifying means grounding or setting a logic variable to a certain value. Here the logic variable is <em>q</em></p>

<pre>
(run* [q] ...)
</pre>

<p>when starting the logical interpreter <em>q</em> is called to be <em>fresh</em> or <em>ungrounded</em>. A logical variable is fresh, iff no assumption are given or deduced on the object referred by the logic variable. In core.logic only those settings (aka <em>solutions</em>) for a logic variable are valid (and therefor returned) which satisfy all constraints <em>c0..cn</em></p>

<pre>
(run* [q]
      c0
      c1
      ...
      cn)
</pre>

<p>To concretize in the first core.logic query we have constraints</p>

<pre>
(run* [q]
      (mann :tobias)
      (== q true))
</pre>

<p>The first constraint is that <em>:tobias</em> is a man, this proposition is true in terms of the previously defined factbase. The second constraint grounds <em>q</em> to be true. So (true) gets returned, since tobias is a man. C'est tout.</p>

<p>The logic interpreter answers the second query by return <em>()</em>, the empty list in Clojure. This means that no solution can be deduced or found that fulfills all constraints. Since </p>

<pre>
(== q true)
</pre>

<p>is an axiomatic constraint the other constraint</p>

<pre>
(mann :heinrich)
</pre>

<p>cannot be fulfilled. So <em>:heinrich:</em> is not a man in our <em>closed world</em>. C'est tout, aussie.</p>

<h2>Getting all solutions</h2>

<p>The logical interpreter tries to find all unifications to the queried logical variable that fulfills the constraints. Here we try to find all women as per our factbase.</p>

<p><table cellpadding=1 cellspacing=0 width="100%" class="sourcetable"><tr><th width="3%"/><th width="48%"/><th width="48%"/></tr><tr><td style='background-color: #eeeeee; border-right: 1px solid #eeaaaa; '><span></span></td><td style='background-color: #eeaaaa; padding-left: 15px; '><span>Prolog</span></td><td style='background-color: #eeaaaa; padding-left: 15px; '><span>Clojure core.logic</span></td></tr><tr><td style='background-color: #eeeeee; border-right: 1px solid #eeaaaa; '><span>1</span></td><td style='background-color: #fdfdfd; '><span style="font-family: 'Courier'; font-size: 1.2em; color: #BA2121">?-</span>&nbsp;<span style="font-family: 'Courier'; font-size: 1.2em; color: #0000FF">frau</span><span style="font-family: 'Courier'; font-size: 1.2em">(</span><span style="font-family: 'Courier'; font-size: 1.2em; color: #19177C">X</span><span style="font-family: 'Courier'; font-size: 1.2em">)</span><span style="font-family: 'Courier'; font-size: 1.2em">.</span></td><td style='background-color: #f8f8f8; '><span style="font-family: 'Courier'; font-size: 1.2em">(</span><span style="font-family: 'Courier'; font-size: 1.2em; color: #0000FF">facts/with-db</span></td></tr><tr><td style='background-color: #eeeeee; border-right: 1px solid #eeaaaa; '><span>2</span></td><td style='background-color: #fafafa; '><span style="font-family: 'Courier'; font-size: 1.2em; color: #19177C">X</span><span style="font-family: 'Courier'; font-size: 1.2em; color: #666666">=</span><span style="font-family: 'Courier'; font-size: 1.2em; color: #BA2121">eva</span></td><td style='background-color: #f5f5f5; '>&nbsp;&nbsp;<span style="font-family: 'Courier'; font-size: 1.2em; color: #19177C">factbase</span></td></tr><tr><td style='background-color: #eeeeee; border-right: 1px solid #eeaaaa; '><span>3</span></td><td style='background-color: #fdfdfd; '><span style="font-family: 'Courier'; font-size: 1.2em; color: #19177C">X</span><span style="font-family: 'Courier'; font-size: 1.2em; color: #666666">=</span><span style="font-family: 'Courier'; font-size: 1.2em; color: #BA2121">daniela</span></td><td style='background-color: #f8f8f8; '>&nbsp;&nbsp;<span style="font-family: 'Courier'; font-size: 1.2em">(</span><span style="font-family: 'Courier'; font-size: 1.2em; color: #0000FF">run*</span>&nbsp;<span style="font-family: 'Courier'; font-size: 1.2em">[</span><span style="font-family: 'Courier'; font-size: 1.2em; color: #19177C">q</span><span style="font-family: 'Courier'; font-size: 1.2em">]</span></td></tr><tr><td style='background-color: #eeeeee; border-right: 1px solid #eeaaaa; '><span>4</span></td><td style='background-color: #fafafa; '><span style="font-family: 'Courier'; font-size: 1.2em; color: #19177C">X</span><span style="font-family: 'Courier'; font-size: 1.2em; color: #666666">=</span><span style="font-family: 'Courier'; font-size: 1.2em; color: #BA2121">ulrike</span></td><td style='background-color: #f5f5f5; '>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="font-family: 'Courier'; font-size: 1.2em">(</span><span style="font-family: 'Courier'; font-size: 1.2em; color: #0000FF">frau</span>&nbsp;<span style="font-family: 'Courier'; font-size: 1.2em; color: #19177C">q</span><span style="font-family: 'Courier'; font-size: 1.2em">)</span><span style="font-family: 'Courier'; font-size: 1.2em">)</span><span style="font-family: 'Courier'; font-size: 1.2em">)</span></td></tr><tr><td style='background-color: #eeeeee; border-right: 1px solid #eeaaaa; '><span>5</span></td><td style='background-color: #fdfdfd; '></td><td style='background-color: #f8f8f8; '><span style="font-family: 'Courier'; font-size: 1.2em; color: #19177C">user=&gt;</span>&nbsp;<span style="font-family: 'Courier'; font-size: 1.2em">(</span><span style="font-family: 'Courier'; font-size: 1.2em; color: #19177C">:ulrike</span>&nbsp;<span style="font-family: 'Courier'; font-size: 1.2em; color: #19177C">:eva</span>&nbsp;<span style="font-family: 'Courier'; font-size: 1.2em; color: #19177C">:daniela</span><span style="font-family: 'Courier'; font-size: 1.2em">)</span></td></tr></table></p>


